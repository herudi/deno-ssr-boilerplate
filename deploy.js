var kt=Object.create;var k=Object.defineProperty;var Tt=Object.getOwnPropertyDescriptor;var Ht=Object.getOwnPropertyNames;var Dt=Object.getPrototypeOf,At=Object.prototype.hasOwnProperty;var Ft=t=>k(t,"__esModule",{value:!0});var L=(t,e)=>()=>(t&&(e=t(t=0)),e);var Ot=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),at=(t,e)=>{for(var o in e)k(t,o,{get:e[o],enumerable:!0})},Wt=(t,e,o,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Ht(e))!At.call(t,r)&&(o||r!=="default")&&k(t,r,{get:()=>e[r],enumerable:!(s=Tt(e,r))||s.enumerable});return t},Lt=(t,e)=>Wt(Ft(k(t!=null?kt(Dt(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);import{join as F,resolve as xt,toFileUrl as S}from"https://deno.land/std@0.126.0/path/mod.ts";import{walk as tt}from"https://deno.land/std@0.126.0/fs/walk.ts";var yt=L(()=>{});var bt={};at(bt,{STORAGE_KEY_API:()=>rt,STORAGE_KEY_PAGE:()=>ot,genPages:()=>wt,genRoutesWithRefresh:()=>de,getListPages:()=>ce});async function ce(){let t=Deno.cwd(),e=[],o=F(t,"./src/pages"),s=S(o),r=tt(o,{includeDirs:!1,includeFiles:!0,exts:["tsx","jsx","ts","js"]});for await(let a of r)if(a.isFile){let i=S(a.path).href.substring(s.href.length);!i.startsWith("/_app.")&&!i.startsWith("/_error.")&&(i.startsWith("/api/")||e.push("./src/pages"+i))}return e}async function ht(t,e,o){let s=e+"/src/pages",r=!1,a=!1;for(let i=0;i<t.length;i++){let n=t[i],E=(await Deno.stat(F(s,n))).mtime?.getTime();o[n]||(o[n]=E,a||(a=!0)),o[n]!==E&&(o[n]=E,r||(r=!0))}return{storage:o,status:r,new_entry:a}}function et(t){let e=t.substring(0,t.lastIndexOf("."));return e.endsWith("/index")&&(e=e.substring(0,e.lastIndexOf("/index"))),e===""&&(e="/"),e="/"+e.split("/").reduce((o,s)=>s.startsWith("[...")&&s.endsWith("]")?o+"/:"+s.slice(4,s.length-1)+"*":s.startsWith("[")&&s.endsWith("]")?o+"/:"+s.slice(1,s.length-1):!o.startsWith("api")&&o!==""?o+"/"+s:s,""),e}function st(t,e,o){return e==="page"&&o==="development"?`
${t.map((s,r)=>`import $${r} from "../../src/pages${s}";`).join(`
`)}
export const map_pages: any = [
  ${t.map((s,r)=>`{ 
    path: '${et(s)}',
    page: $${r},
    methods: ($${r} as any).methods
  },`).join(`
  `)}
];
export const tt: string = '${Date.now()}';
`:e==="page"&&o==="production"?`
export const map_pages = [
  ${t.map(s=>{let r=et(s),a=s.replace(".tsx",".js").replace(".jsx",".js");return`{ 
    path: '${r}',
    page: '.${a}'
  },`}).join(`
  `)}
];
export const tt: string = '${Date.now()}';
`:`
import { Router } from "https://deno.land/x/nhttp@1.1.10/mod.ts";
import { RequestEvent } from "./../deps/types.ts";
${t.map((s,r)=>`import $${r} from "../../src/pages${s}";`).join(`
`)}
const api = new Router<RequestEvent>();
  ${t.map((s,r)=>`api.any('${et(s)}', $${r});`).join(`
  `)}
export default api;
`}async function wt(t=!1,e="development",o=Deno.cwd()){try{o=xt(o);let s=JSON.parse(localStorage.getItem(ot)||"{}"),r=JSON.parse(localStorage.getItem(rt)||"{}"),a=[],i=[],n=F(o,"./src/pages"),c=S(n),E=tt(n,{includeDirs:!1,includeFiles:!0,exts:["tsx","jsx","ts","js"]});for await(let j of E)if(j.isFile){let v=S(j.path).href.substring(c.href.length);!v.startsWith("/_app.")&&!v.startsWith("/_error.")&&(v.startsWith("/api/")?i.push(v):a.push(v))}let y=await ht(a,o,s),q=await ht(i,o,r);if((y.new_entry||y.status||t)&&localStorage.setItem(ot,JSON.stringify(y.storage)),(q.new_entry||q.status||t)&&localStorage.setItem(rt,JSON.stringify(q.storage)),y.status||t){let j=st(a,"page",e),v=o+"/_core/result/pages.ts";if(await Deno.writeTextFile(v,j),e==="production"){let St=st(a,"page","development"),qt=o+"/_core/result/server_pages.ts";await Deno.writeTextFile(qt,St)}}if(q.status||t){let j=st(i,"api",e),v=o+"/_core/result/apis.ts";await Deno.writeTextFile(v,j)}}catch(s){return console.log(s),s}}async function de(t){return localStorage.clear(),await wt(!0,t)}var ot,rt,vt=L(()=>{yt();ot="95d6aa06f620",rt="01a2929d18cf"});var Et={};at(Et,{map_pages:()=>ue,tt:()=>ge});var ue,ge,_t=L(()=>{ue=[{path:"/blog",page:"./blog/index.js"},{path:"/blog/:title",page:"./blog/[title].js"},{path:"/",page:"./index.js"},{path:"/sign",page:"./sign.js"}],ge="1646808121930"});var jt=Ot((xs,fe)=>{fe.exports={imports:{"nano-jsx":"https://deno.land/x/nano_jsx@v0.0.30/mod.ts",twind:"https://cdn.skypack.dev/twind@0.16.16",nhttp:"https://deno.land/x/nhttp@1.1.10/mod.ts",types:"./_core/deps/types.ts"}}});import{h as Pt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{Helmet as Nt,renderSSR as Ct}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{setup as Gt}from"https://cdn.skypack.dev/twind@0.16.16";import{getStyleTag as It,virtualSheet as Jt}from"https://cdn.skypack.dev/twind@0.16.16/sheets";var N=Jt();Gt({sheet:N});var Bt=({body:t,attributes:e,head:o,footer:s,styleTag:r,clientScript:a,env:i,initData:n,tt:c})=>`<!DOCTYPE html>
<html ${e.html.toString()}>
  <head>
    ${o.join(`
    `)}
    ${r}
  </head>
  ${e.body.size===0?"<body>":`<body ${e.body.toString()}>`}
    <div id="root">${t}</div>
    ${n!==void 0?`<script id="__INIT_DATA__" type="application/json">${JSON.stringify(n)}<\/script>`:""}${s.join(`
    `)}${i==="development"?'<script src="/assets/js/refresh.js"><\/script>':""}${a?`<script type="module" src="${a+"?v="+c}"><\/script>`:""}
  </body>
<html>
`;function C(t,e={}){N.reset();let o=Ct(t,e),{body:s,head:r,footer:a,attributes:i}=Nt.SSR(o),n=It(N);return Bt({...e,body:s,head:r,footer:a,styleTag:n,attributes:i})}import{HttpError as nt,NHttp as xe}from"https://deno.land/x/nhttp@1.1.10/mod.ts";import ye from"https://deno.land/x/static_files@1.1.6/mod.ts";import{h as Mt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{h as w,Helmet as zt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{h as f,Router as Ut}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as h}from"https://cdn.skypack.dev/twind@0.16.16";var{Link:G}=Ut,I="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium",T="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium";function J({route:t}){return f("nav",{class:h`bg-gray-800 sticky top-0 z-10`},f("div",{class:h`max-w-7xl mx-auto px-2 sm:px-6 lg:px-8`},f("div",{class:h`relative flex items-center justify-between h-16`},f("div",{class:h`flex-1 flex items-center justify-center sm:items-stretch sm:justify-start`},f("div",{class:h`sm:block sm:ml-6`},f("div",{class:h`flex space-x-4`},f(G,{class:h`${t.pathname==="/"?I:T}`,to:"/"},"Home"),f(G,{class:h`${t.pathname.startsWith("/blog")?I:T}`,to:"/blog"},"Blog"),f(G,{class:h`${t.pathname==="/sign"?I:T}`,to:"/sign"},"Sign Form")))),f("div",{class:"absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0"},f("a",{class:h`${T}`,href:"https://github.com/herudi/deno-ssr-boilerplate",target:"__blank"},"Github")))))}function it({Component:t,props:e}){return w("div",null,w(zt,null,w("html",{lang:"en"}),w("meta",{charset:"utf-8"}),w("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),w("link",{rel:"icon",href:"data:,"}),w("script",{src:"https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"}),w("link",{href:"https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css",rel:"stylesheet"})),e.route.pathname==="/sign"||e.error?null:w(J,{route:e.route}),w(t,{...e}))}var B;it.event={onStart(t){t.NProgress=window.NProgress,t.isFirst||(B=setTimeout(()=>{t.NProgress.start()},300))},onEnd({NProgress:t}){B&&clearTimeout(B),t.done()},onError(t){console.error(t)}};var H=it;function U({Page:t,initData:e,route:o,isServer:s}){return Mt(H,{Component:t,props:{...e,route:o,isServer:s}})}U.initProps=H.initProps;U.event=H.event||{};var D=U;import{Component as Kt,h as l,Helmet as Qt,Router as Xt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as u}from"https://cdn.skypack.dev/twind@0.16.16";import{h as b,Helmet as Yt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as P}from"https://cdn.skypack.dev/twind@0.16.16";function Vt({message:t="something went wrong",status:e=500}){return b("div",null,b(Yt,null,b("title",null,e," ",t)),b("div",{class:P`flex items-center justify-center w-screen h-screen`},b("div",{class:P`px-40 py-20 bg-white rounded-md`},b("div",{class:P`flex flex-col items-center`},b("h1",{class:P`font-bold text-blue-600 text-9xl`},e),b("h6",{class:P`mb-2 text-2xl font-bold text-center text-gray-800 md:text-3xl`},b("span",{class:"text-red-500"},"Oops!")," Error"),b("p",{class:P`mb-8 text-center text-gray-500 md:text-lg`},t)))))}var $=Vt;var{Link:pt}=Xt,lt=class extends Kt{static async initProps({fetchApi:e}){let{data:o,error:s}=await e("/api/blog");return{data:o,error:s}}didMount(){window.scrollTo(0,0)}render(){return this.props.error?l($,{...this.props.error}):l("div",null,l(Qt,null,l("title",null,"Hello Blog Page")),l("div",{class:u`bg-white min-h-screen`},l("main",{class:u`max-w-5xl mx-auto px-4 pb-28 sm:px-6 md:px-8 xl:px-12 xl:max-w-6xl`},l("header",{class:u`pt-10 pb-9 sm:pb-16 sm:text-center`},l("h1",{class:u`mb-4 text-3xl sm:text-4xl tracking-tight font-extrabold`},"Blog"),l("p",{class:u`text-lg`},"Example blog page with dummy data")),l("div",{class:u`space-y-16`},this.props.data.map(e=>l("article",{class:u`relative flex flex-col max-w-3xl lg:ml-auto xl:max-w-none xl:w-[50rem]`},l("h3",{class:u`mb-4 text-xl tracking-tight font-bold`},l(pt,{to:"/blog/"+e.title},e.title)),l("div",{class:u`mb-6`},l("p",null,e.body)),l("div",{class:u`mt-auto flex flex-row-reverse items-center justify-end`},l("div",{class:u`text-sm leading-6 lg:absolute lg:top-0 lg:right-full lg:mr-8 lg:whitespace-nowrap`},"January, 12 2030"),l(pt,{to:"/blog/"+e.title,class:u`px-6 py-2 text-sm font-semibold text-blue-800 bg-blue-100`},"Read More"))))))))}},z=lt;import{Component as Zt,h as x,Helmet as te,Router as ee}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as R}from"https://cdn.skypack.dev/twind@0.16.16";var{Link:se}=ee,mt=class extends Zt{static async initProps({fetchApi:e,params:o}){let{data:s,error:r}=await e("/api/blog/"+o.title);return{data:s,error:r}}didMount(){window.scrollTo(0,0)}render(){if(this.props.error)return x($,{...this.props.error});let e=this.props.route;return x("div",null,x(te,null,x("title",null,e.params.title)),x("div",{class:R`bg-white flex h-screen`},x("div",{class:R`max-w-5xl mx-auto px-4 pb-28 mt-10 sm:px-6 md:px-8 xl:px-12 xl:max-w-6xl`},x("div",null,x("div",{class:R`text-sm sm:text-center`},"January, 12 2030"),x("h1",{class:R`col-span-full text-3xl sm:text-4xl sm:text-center xl:mb-16 font-extrabold tracking-tight`},e.params.title),x("p",{class:R`mb-20`},this.props.data.body),x(se,{to:"/blog",class:R`px-6 py-2 text-sm font-semibold text-blue-800 bg-blue-100`},"Back")))))}},M=mt;import{Component as oe,h as g,Helmet as re}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as _}from"https://cdn.skypack.dev/twind@0.16.16";var ct={button:"text-2xl px-6 py-2 text-sm font-semibold text-white bg-gray-800"},dt=class extends oe{constructor(){super(...arguments);this.value=0}changeValue(e){this.value+=e,this.update()}render(){return g("div",null,g(re,null,g("title",null,"Hello Home Page")),g("div",{class:_`bg-white flex justify-center h-screen`},g("div",null,g("div",{class:_`text-center mt-20 mb-10 text-gray-600`},g("h3",{class:_`text-5xl`},"Welcome Home"),g("p",{class:_`text-2xl`},"Example Counter App")),g("div",{class:_`text-center`},g("button",{class:_`${ct.button}`,onClick:()=>this.changeValue(1)},"+"),g("span",{class:_`p-5 text-2xl text-sm font-bold text-blue-800`},this.value),g("button",{class:_`${ct.button}`,onClick:()=>this.changeValue(-1)},"-")))))}},Y=dt;import{Component as ne,h as p,Helmet as ae}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as m}from"https://cdn.skypack.dev/twind@0.16.16";var ut={input:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"},V=class extends ne{static async initProps(e){if(e.isServer&&e.request.method==="POST"){let{data:o}=await e.fetchApi("/api/sign");return o.message==="success"?e.response.redirect("/"):{message:o.message}}return{}}render(){return p("div",null,p(ae,null,p("title",null,"Sign Page")),p("div",{class:m`min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8`},p("div",{class:m`max-w-sm w-full space-y-8`},p("div",null,p("h2",{class:m`mt-6 text-center text-3xl font-extrabold text-gray-900`},"Sign Page"),p("p",{class:m`text-center`},"(Example handle form with POST)"),this.props.message&&p("div",{class:m`mt-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative`,role:"alert"},p("strong",{class:m`font-bold`},"Error"),p("span",{class:m`block sm:inline`},this.props.message),p("span",{class:m`absolute top-0 bottom-0 right-0 px-4 py-3`},p("svg",{class:m`fill-current h-6 w-6 text-red-500`,role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},p("title",null,"Close"),p("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})))),p("form",{class:m`mt-8 space-y-6`,action:"/sign",method:"POST"},p("div",{class:m`rounded-md shadow-sm -space-y-px`},p("div",null,p("label",{class:m`sr-only`},"Username"),p("input",{name:"username",type:"text",class:m`${ut.input}`,placeholder:"Username = deno",requied:!0})),p("div",null,p("label",{class:m`sr-only`},"Password"),p("input",{name:"password",type:"password",class:m`${ut.input}`,placeholder:"Password = deno",requied:!0}))),p("div",null,p("button",{type:"submit",class:m`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`},"Sign in")))))))}};V.methods=["GET","POST"];var K=V;var gt=[{path:"/blog",page:z,methods:z.methods},{path:"/blog/:title",page:M,methods:M.methods},{path:"/",page:Y,methods:Y.methods},{path:"/sign",page:K,methods:K.methods}];import{Router as me}from"https://deno.land/x/nhttp@1.1.10/mod.ts";import{HttpError as ie}from"https://deno.land/x/nhttp@1.1.10/mod.ts";async function Q(t){if(t.request.method=="GET")return await(await fetch("https://jsonplaceholder.typicode.com/posts?_limit=10")).json();throw new ie(405,"method not allowed")}import{HttpError as pe}from"https://deno.land/x/nhttp@1.1.10/mod.ts";async function X(t){if(t.request.method=="GET")return(await(await fetch(`https://jsonplaceholder.typicode.com/posts?title=${t.params.title}`)).json())[0]||{};throw new pe(405,"method not allowed")}import{HttpError as le}from"https://deno.land/x/nhttp@1.1.10/mod.ts";async function Z(t){if(t.request.method=="GET")return{};if(t.request.method=="POST"){let{username:e,password:o}=t.body;return e==="deno"&&o==="deno"?{message:"success"}:{message:"wrong username and password"}}throw new le(405,"method not allowed")}var A=new me;A.any("/blog",Q);A.any("/blog/:title",X);A.any("/sign",Z);var ft=A;var O=(Deno.args||[]).includes("--dev")?"development":"production",$t="/assets/pages/_app.js",he=Date.now(),W=[],d=new xe({env:O});if(O==="development"){try{await Deno.remove(Deno.cwd()+"/public/pages",{recursive:!0})}catch{}let{genPages:t}=await Promise.resolve().then(()=>(vt(),bt)),{map_pages:e}=await Promise.resolve().then(()=>(_t(),Et)),o=await import("https://deno.land/x/esbuild@v0.14.22/mod.js"),s=await import("https://esm.sh/esbuild-plugin-import-map?no-check"),r=(await Promise.resolve().then(()=>Lt(jt()))).default;r.imports["nano-jsx"]="https://cdn.skypack.dev/nano-jsx@v0.0.30",W=e,await t(),s.load(r);let i=(await o.build({jsxFactory:"h",jsxFragment:"Fragment",format:"esm",write:!1,bundle:!0,plugins:[s.plugin()],entryPoints:["./_core/tsx/hydrate.tsx"],minify:!0})).outputFiles[0]?.contents;i&&d.get($t,({response:n})=>(n.type("application/javascript"),i)),d.get("/__REFRESH__",({response:n})=>(n.type("text/event-stream"),new ReadableStream({start(c){c.enqueue(`data: reload
retry: 100

`)},cancel(c){console.log(c)}}).pipeThrough(new TextEncoderStream))),d.get("/assets/js/refresh.js",({response:n})=>(n.type("application/javascript"),`let bool = false; new EventSource("/__REFRESH__").addEventListener("message", _ => {
      if (bool) location.reload();
      else bool = true;
    });`))}else W=gt;d.use("/assets",ye("public"));d.use((t,e)=>(t.getBaseUrl=()=>new URL(t.request.url).origin,t.isServer=!0,t.env=O,t.pathname=t.path,t.fetchApi=async o=>{let s=d.route.ANY,r=0,a=s.length,i;for(;r<a;){let n=s[r];if(n.pathx.test(o)){i=n.fns;break}r++}if(!i)throw new nt(404,`${o} not found`);try{if(i.length===1)return{data:await i[0](t,e),error:void 0};let n=0,c=y=>{if(y)throw y instanceof Error?y:new nt(500,String(y));return i[n++](t,c)};return{data:await c(),error:void 0}}catch(n){return{data:void 0,error:{status:n.status||500,message:n.message||"Something went wrong"}}}},t.render=async(o,s)=>{t.response.type("text/html; charset=utf-8");let r=D.initProps?await D.initProps(t):{};if(r){let a=s.initData||{};s.initData={...a,...r}}return C(Pt(D,{isServer:!0,initData:s.initData,Page:o,route:{url:t.url,pathname:t.path,path:s.path,params:t.params}}),{clientScript:$t,env:O,initData:s.initData,tt:he})},e()));d.use("/api",ft);d.on404(t=>{throw new nt(404,`${t.url} not found`)});d.onError((t,e)=>{let o=e.response.status();return e.path.startsWith("/api/")?{status:o,message:t.message}:(e.response.type("text/html; charset=utf-8"),C(Pt($,{message:t.message,status:o})))});var Rt=t=>{let e={};t&&(t(d),e=d.route);for(let o=0;o<W.length;o++){let s=W[o],r=s.methods||["GET"];for(let a=0;a<r.length;a++){let i=r[a];e[i+s.path]||d.on(i,s.path,async n=>{let c=s.page,E=c.initProps?await c.initProps(n):void 0;return n.render(c,{path:s.path,initData:E})})}}return d};Rt().listen(8080,()=>{console.log("> Running on http://localhost:8080")});
