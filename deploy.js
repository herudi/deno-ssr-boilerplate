import{h as M}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{Helmet as Pt,renderSSR as St}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{setup as qt}from"https://cdn.skypack.dev/twind@0.16.16";import{getStyleTag as Dt,virtualSheet as Ht}from"https://cdn.skypack.dev/twind@0.16.16/sheets";import kt from"https://cdn.skypack.dev/@twind/typography@0.0.2";var Q=null;function X(t={}){return Q??(Q=Tt(t))}function Tt(t){let e=Ht();return qt({...t,sheet:e,plugins:{...kt()}}),e}var At=({body:t,head:e,footer:s,styleTag:o,clientScript:r,env:a,initData:p,tt:l})=>`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    ${e.join(`
    `)}
    ${o}
  </head>
  <body>
    <div id="root">${t}</div>
    <script>window.__INIT_DATA__ = ${JSON.stringify(p)}<\/script>${s.join(`
    `)}${a==="development"?'<script src="/assets/js/refresh_client.js"><\/script>':""}<script type="module" src="${r+"?v="+l}"><\/script>
  </body>
<html>
`;function D(t,e={}){X(e.tw??{}).reset();let s=St(t,e),{body:o,head:r,footer:a}=Pt.SSR(s),p=Dt(X());return new Response(At({...e,body:o,head:r,footer:a,styleTag:p}),{headers:{"content-type":"text/html"},status:e.status||200})}import{NHttp as Xt}from"https://deno.land/x/nhttp@1.1.10/mod.ts";import Zt from"https://deno.land/x/static_files@1.1.6/mod.ts";import{refresh as te}from"https://deno.land/x/refresh@1.0.0/mod.ts";import{h as Wt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{h as w,Helmet as Ft}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{h as d,Router as Ot}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as f}from"https://cdn.skypack.dev/twind@0.16.16";var{Link:N}=Ot,B="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium",I="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium";function U({route:t}){return d("nav",{class:f`bg-gray-800 sticky top-0 z-10`},d("div",{class:f`max-w-7xl mx-auto px-2 sm:px-6 lg:px-8`},d("div",{class:f`relative flex items-center justify-between h-16`},d("div",{class:f`flex-1 flex items-center justify-center sm:items-stretch sm:justify-start`},d("div",{class:f`sm:block sm:ml-6`},d("div",{class:f`flex space-x-4`},d(N,{class:f`${t.pathname==="/"?B:I}`,to:"/"},"Home"),d(N,{class:f`${t.pathname.startsWith("/blog")?B:I}`,to:"/blog"},"Blog"),d(N,{class:f`${t.pathname==="/about"?B:I}`,to:"/about"},"About")))))))}import Z from"https://esm.sh/nprogress?no-check";function H({Component:t,props:e}){return w("div",null,w(Ft,{head:!0},w("link",{rel:"icon",href:"data:,"}),w("link",{href:"https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css",rel:"stylesheet"})),w(U,{route:e.route}),w(t,{...e}))}var G;H.onStart=()=>{G=setTimeout(()=>{Z.start()},300)};H.onEnd=()=>{G&&clearTimeout(G),Z.done()};H.onError=t=>{console.error(t)};var j=H;function tt({Page:t,initData:e,route:s,isServer:o}){return Wt(j,{Component:t,props:{...e,route:s,isServer:o}})}tt.event={onStart:j.onStart,onEnd:j.onEnd,onError:j.onError};var et=tt;import{join as J,resolve as st,toFileUrl as C}from"https://deno.land/std@0.126.0/path/mod.ts";import{walk as ot}from"https://deno.land/std@0.126.0/fs/walk.ts";var rt="95d6aa06f620",at="01a2929d18cf";async function nt(t,e,s){let o=e+"/src/pages",r=!1,a=!1;for(let p=0;p<t.length;p++){let l=t[p],$=(await Deno.stat(J(o,l))).mtime?.getTime();s[l]||(s[l]=$,a||(a=!0)),s[l]!==$&&(s[l]=$,r||(r=!0))}return{storage:s,status:r,new_entry:a}}function V(t){let e=t.substring(0,t.lastIndexOf("."));return e.endsWith("/index")&&(e=e.substring(0,e.lastIndexOf("/index"))),e===""&&(e="/"),e="/"+e.split("/").reduce((s,o)=>o.startsWith("[...")&&o.endsWith("]")?s+"/:"+o.slice(4,o.length-1)+"*":o.startsWith("[")&&o.endsWith("]")?s+"/:"+o.slice(1,o.length-1):o,""),e}function Y(t,e,s){return e==="page"&&s==="development"?`
${t.map((o,r)=>`import $${r} from "../../src/pages${o}";`).join(`
`)}
export const map_pages = [
  ${t.map((o,r)=>`{ 
    path: '${V(o)}',
    page: $${r}
  },`).join(`
  `)}
];
export const tt: string = '${Date.now()}';
export const env: string = '${s}';
`:e==="page"&&s==="production"?`
export const map_pages = [
  ${t.map(o=>{let r=V(o),a=o.replace(".tsx",".js").replace(".jsx",".js");return`{ 
    path: '${r}',
    page: '.${a}'
  },`}).join(`
  `)}
];
export const tt: string = '${Date.now()}';
export const env: string = '${s}';
`:`
import { Router, Handler } from "https://deno.land/x/nhttp@1.1.10/mod.ts";
import { RequestEvent } from "./../deps/types.ts";
${t.map((o,r)=>`import $${r} from "../../src/pages${o}";`).join(`
`)}
const api = new Router<RequestEvent>();
const map = {} as Record<string, Handler<RequestEvent>>;
  ${t.map((o,r)=>{let a=V(o);return`
map['${o}'] = $${r};
api.any('${a}', $${r});`}).join(`
  `)}
export default { api, map };
`}async function it(t=!1,e="development",s=Deno.cwd()){try{s=st(s);let o=JSON.parse(localStorage.getItem(rt)||"{}"),r=JSON.parse(localStorage.getItem(at)||"{}"),a=[],p=[],l=J(s,"./src/pages"),z=C(l),$=ot(l,{includeDirs:!1,includeFiles:!0,exts:["tsx","jsx","ts","js"]});for await(let y of $)if(y.isFile){let g=C(y.path).href.substring(z.href.length);g.startsWith("/_app.")||(g.startsWith("/api/")?p.push(g):a.push(g))}let S=await nt(a,s,o),q=await nt(p,s,r);if((S.new_entry||S.status||t)&&localStorage.setItem(rt,JSON.stringify(S.storage)),(q.new_entry||q.status||t)&&localStorage.setItem(at,JSON.stringify(q.storage)),S.status||t){let y=Y(a,"page",e),g=s+"/_core/result/pages.ts";if(await Deno.writeTextFile(g,y),e==="production"){let jt=Y(a,"page","development"),Rt=s+"/_core/result/server_pages.ts";await Deno.writeTextFile(Rt,jt)}}if(q.status||t){let y=Y(p,"api",e),g=s+"/_core/result/apis.ts";await Deno.writeTextFile(g,y)}}catch(o){return console.log(o),o}}var pt=[{path:"/about",page:"./about.js"},{path:"/blog",page:"./blog/index.js"},{path:"/blog/:title",page:"./blog/[title].js"},{path:"/",page:"./index.js"}];import{h as R,Helmet as Lt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as lt}from"https://cdn.skypack.dev/twind@0.16.16";function mt(t){return R("div",{id:"about"},R(Lt,null,R("title",null,t.title)),R("div",{class:lt`bg-white flex h-screen`},R("h1",{class:lt`text-5xl text-green-600 m-auto mt-20`},t.title||"loading...")))}mt.initProps=async t=>t.isServer?await t.handler("/api/about.ts"):await(await fetch(t.getBaseUrl()+"/api/about")).json();var ct=mt;import{h as n,Helmet as Nt,Router as Bt}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as i}from"https://cdn.skypack.dev/twind@0.16.16";var{Link:ut}=Bt;function dt({data:t}){return n("div",null,n(Nt,{head:!0},n("title",null,"Hello Blog Page")),n("div",{class:i`bg-white min-h-screen`},n("main",{class:i`max-w-5xl mx-auto px-4 pb-28 sm:px-6 md:px-8 xl:px-12 xl:max-w-6xl`},n("header",{class:i`pt-10 pb-9 sm:pb-16 sm:text-center`},n("h1",{class:i`mb-4 text-3xl sm:text-4xl tracking-tight font-extrabold`},"Blog"),n("p",{class:i`text-lg`},"Example blog page with dummy data")),n("div",{class:i`space-y-16`},t.map(e=>n("article",{class:i`relative flex flex-col max-w-3xl lg:ml-auto xl:max-w-none xl:w-[50rem]`},n("h3",{class:i`mb-4 text-xl tracking-tight font-bold`},n(ut,{to:"/blog/"+e.title},e.title)),n("div",{class:i`mb-6`},n("p",null,e.body)),n("div",{class:i`mt-auto flex flex-row-reverse items-center justify-end`},n("div",{class:i`text-sm leading-6 lg:absolute lg:top-0 lg:right-full lg:mr-8 lg:whitespace-nowrap`},"January, 12 2030"),n(ut,{to:"/blog/"+e.title,class:i`px-6 py-2 text-sm font-semibold text-blue-800 bg-blue-100`},"Read More"))))))))}dt.initProps=async t=>{let e;return t.isServer?e=await t.handler("/api/blog/index.ts"):(e=await(await fetch(t.getBaseUrl()+"/api/blog")).json(),window.scrollTo(0,0)),{data:e}};var ft=dt;import{h as m,Helmet as It,Router as Ut}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as v}from"https://cdn.skypack.dev/twind@0.16.16";var{Link:Gt}=Ut;function gt({data:t,route:e}){return m("div",null,m(It,null,m("title",null,e.params.title)),m("div",{class:v`bg-white flex h-screen`},m("div",{class:v`max-w-5xl mx-auto px-4 pb-28 mt-10 sm:px-6 md:px-8 xl:px-12 xl:max-w-6xl`},m("div",null,m("div",{class:v`text-sm sm:text-center`},"January, 12 2030"),m("h1",{class:v`col-span-full text-3xl sm:text-4xl sm:text-center xl:mb-16 font-extrabold tracking-tight`},e.params.title),m("p",{class:v`mb-20`},t.body),m(Gt,{to:"/blog",class:v`px-6 py-2 text-sm font-semibold text-blue-800 bg-blue-100`},"Back")))))}gt.initProps=async t=>{let e;return t.isServer?e=await t.handler("/api/blog/[title].ts"):(e=await fetch(t.getBaseUrl()+"/api/blog/"+t.params.title),e=await e.json(),window.scrollTo(0,0)),{data:e[0]||{}}};var xt=gt;import{Component as Jt,h as c,Helmet as Ct}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as E}from"https://cdn.skypack.dev/twind@0.16.16";var ht={button:"text-2xl px-6 py-2 text-sm font-semibold text-blue-800 bg-blue-100"},bt=class extends Jt{constructor(){super(...arguments);this.value=0}changeValue(e){this.value+=e,this.update()}render(){return c("div",null,c(Ct,null,c("title",null,"Hello Home Page")),c("div",{class:E`bg-white flex justify-center h-screen`},c("div",null,c("h3",{class:E`text-5xl text-center mt-20 mb-20 text-gray-600`},"Counter App"),c("div",{class:E`text-center`},c("button",{class:E`${ht.button}`,onClick:()=>this.changeValue(1)},"+"),c("span",{class:E`p-5 text-2xl text-sm font-semibold text-blue-800`},this.value),c("button",{class:E`${ht.button}`,onClick:()=>this.changeValue(-1)},"-")))))}},yt=bt;var wt=[{path:"/about",page:ct},{path:"/blog",page:ft},{path:"/blog/:title",page:xt},{path:"/",page:yt}];import{Router as Mt}from"https://deno.land/x/nhttp@1.1.10/mod.ts";import{HttpError as Vt}from"https://deno.land/x/nhttp@1.1.10/mod.ts";async function k(t){if(t.request.method=="GET")return{title:"Welcome About From Api"};throw new Vt(405,"method not allowed")}import{HttpError as Yt}from"https://deno.land/x/nhttp@1.1.10/mod.ts";async function T(t){if(t.request.method=="GET")return await(await fetch("https://jsonplaceholder.typicode.com/posts?_limit=10")).json();throw new Yt(405,"method not allowed")}import{HttpError as Kt}from"https://deno.land/x/nhttp@1.1.10/mod.ts";async function A(t){if(t.request.method=="GET")return await(await fetch(`https://jsonplaceholder.typicode.com/posts?title=${t.params.title}`)).json();throw new Kt(405,"method not allowed")}var O=new Mt,F={};F["/api/about.ts"]=k;O.any("/about",k);F["/api/blog/index.ts"]=T;O.any("/blog",T);F["/api/blog/[title].ts"]=A;O.any("/blog/:title",A);var K={api:O,map:F};import{h as x}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as h}from"https://cdn.skypack.dev/twind@0.16.16";function zt({message:t}){return x("div",{class:h`flex items-center justify-center w-screen h-screen`},x("div",{class:h`px-40 py-20 bg-white rounded-md`},x("div",{class:h`flex flex-col items-center`},x("h1",{class:h`font-bold text-blue-600 text-9xl`},"404"),x("h6",{class:h`mb-2 text-2xl font-bold text-center text-gray-800 md:text-3xl`},x("span",{class:"text-red-500"},"Oops!")," Page not found"),x("p",{class:h`mb-8 text-center text-gray-500 md:text-lg`},t||"not found"),x("a",{href:"/",class:h`px-6 py-2 text-sm font-semibold text-blue-800 bg-blue-100`},"Go home"))))}var vt=zt;import{h as b}from"https://deno.land/x/nano_jsx@v0.0.30/mod.ts";import{tw as _}from"https://cdn.skypack.dev/twind@0.16.16";function Qt({message:t,status:e}){return b("div",{class:_`flex items-center justify-center w-screen h-screen`},b("div",{class:_`px-40 py-20 bg-white rounded-md`},b("div",{class:_`flex flex-col items-center`},b("h1",{class:_`font-bold text-blue-600 text-9xl`},e||500),b("h6",{class:_`mb-2 text-2xl font-bold text-center text-gray-800 md:text-3xl`},b("span",{class:"text-red-500"},"Oops!")," Error"),b("p",{class:_`mb-8 text-center text-gray-500 md:text-lg`},t||"something went wrong"))))}var Et=Qt;var _t="/assets/pages/_app.js",ee=Date.now(),W=(Deno.args||[]).includes("--dev")?"development":"production",P,L=[],u=new Xt({env:W});if(W==="development"){L=pt;try{await Deno.remove(Deno.cwd()+"/public/pages",{recursive:!0})}catch{}await it();let t={check:!1,bundle:"module",compilerOptions:{lib:["dom","dom.iterable","esnext"],jsxFactory:"h",jsxFragmentFactory:"Fragment"},importMapPath:"./import_map.json"};P=await Deno.emit("./_core/tsx/hydrate.tsx",t);let e=te({paths:"./src/pages/"});u.use((s,o)=>{let r=e(s.request);return r||o()})}else L=wt;u.use("/assets",Zt("public"));u.use((t,e)=>(t.getBaseUrl=()=>new URL(t.request.url).origin,t.isServer=!0,t.env=W,t.pathname=t.path,t.handler=async s=>(s.startsWith("/")||(s="/"+s),await K.map[s](t,e)),t.render=(s,o)=>D(M(et,{isServer:!0,initData:o.initData||{},Page:s,route:{url:t.url,pathname:t.path,path:o.path,params:t.params}}),{clientScript:_t,env:W,initData:o.initData||{},tt:ee}),e()));for(let t=0;t<L.length;t++){let e=L[t];u.get(e.path,async s=>{s.getBaseUrl=()=>new URL(s.request.url).origin;let o=e.page,r=o.initProps?await o.initProps(s):{};return s.render(o,{path:e.path,initData:r})})}P&&u.get(_t,({response:t})=>(t.type("application/javascript"),P.files["deno:///bundle.js"]));u.use("/api",K.api);P&&u.get("/assets/hydrates/app.js",({response:t})=>(t.type("application/javascript"),P.files["deno:///bundle.js"]));u.on404(t=>t.path.startsWith("/api/")?{status:404,message:`route ${t.url} not found`}:D(M(vt,{message:`route ${t.url} not found`,status:404}),{status:404}));u.onError((t,e)=>{let s=e.response.status();return e.path.startsWith("/api/")?{status:s,message:t.message}:D(M(Et,{message:t.message,status:s}),{status:s})});var $t=u;$t.listen(8080,()=>{console.log("> running on port 8080")});
